{% extends "ba_office/base_office.html" %}
{% load static %}

{% block left_menu %}
{% include "ba_office/includes/lfmember_left.html" %}
{% endblock %}

{% block extra_js %}
<script>
function fn_child_idcheck() {
    var cid = document.regform.child_id.value.trim();
    if (!cid || cid.length < 6) { alert('자녀 아이디는 6자 이상 입력해주세요.'); return; }
    var xhr = new XMLHttpRequest();
    xhr.open('GET', '{% url "office_member_idcheck" %}?member_id=' + encodeURIComponent(cid));
    xhr.onload = function() {
        var res = JSON.parse(xhr.responseText);
        if (res.exists) {
            alert('이미 사용 중인 아이디입니다.');
        } else {
            alert('사용 가능한 아이디입니다.');
            document.regform.id_dup_chk.value = 'T';
        }
    };
    xhr.send();
}

function fn_submit() {
    var f = document.regform;
    if (!f.child_name.value.trim()) { alert('이름을 입력해주세요.'); f.child_name.focus(); return; }
    if (!f.child_id.value.trim() || f.child_id.value.trim().length < 6) { alert('아이디는 6자 이상 입력해주세요.'); f.child_id.focus(); return; }
    if (!f.child_pwd.value.trim() || f.child_pwd.value.trim().length < 8) { alert('비밀번호는 8자 이상 입력해주세요.'); f.child_pwd.focus(); return; }
    if (f.child_pwd.value != f.child_pwd_con.value) { alert('비밀번호가 일치하지 않습니다.'); f.child_pwd_con.focus(); return; }
    f.submit();
}
</script>
{% endblock %}

{% block content %}
<div class="navi">HOME  &gt;  회원관리  &gt;  회원정보</div>
<div class="h_55"></div>

<p class="title">자녀추가 (학부모: {{ member.name }} / {{ member.username }})</p>

{% if error %}
<div style="color:red; margin-bottom:10px; font-weight:bold; padding-left:10px;">{{ error }}</div>
{% endif %}

<div class="tb_basic">
<form name="regform" method="post" action="{% url 'office_member_childadd' member.username %}">
{% csrf_token %}
<input type="hidden" name="id_dup_chk" value="F" />
<table summary="ems" border="0" cellpadding="0" cellspacing="0">
    <colgroup><col width="15%" /><col width="85%" /></colgroup>
    <tbody>
        <tr><th scope="col">이름 *</th><td class="left"><input type="text" name="child_name" value="{{ form_data.child_name|default:'' }}" size="10" maxlength="10" /></td></tr>
        <tr><th scope="col">아이디 *</th><td class="left"><input type="text" name="child_id" value="{{ form_data.child_id|default:'' }}" size="16" maxlength="16" /> <a href="javascript:fn_child_idcheck();"><img src="{% static 'ba_office/images/btn_check.gif' %}" alt="중복확인" /></a></td></tr>
        <tr><th scope="col">비밀번호 *</th><td class="left"><input type="password" name="child_pwd" size="16" maxlength="16" /> (8자 이상)</td></tr>
        <tr><th scope="col">비밀번호 확인 *</th><td class="left"><input type="password" name="child_pwd_con" size="16" maxlength="16" /></td></tr>
        <tr><th scope="col">생년월일</th><td class="left"><input type="text" name="child_birth" value="{{ form_data.child_birth|default:'' }}" size="8" maxlength="8" /> (YYYYMMDD)</td></tr>
        <tr><th scope="col">학교명</th><td class="left"><input type="text" name="sch_name" value="{{ form_data.sch_name|default:'' }}" size="20" maxlength="20" /></td></tr>
        <tr><th scope="col">학년</th><td class="left"><input type="text" name="sch_grade" value="{{ form_data.sch_grade|default:'' }}" size="10" maxlength="10" /></td></tr>
        <tr><th scope="col">신장(cm)</th><td class="left"><input type="text" name="child_height" value="{{ form_data.child_height|default:'' }}" size="3" maxlength="3" /></td></tr>
        <tr><th scope="col">체중(kg)</th><td class="left"><input type="text" name="child_weight" value="{{ form_data.child_weight|default:'' }}" size="3" maxlength="3" /></td></tr>
        <tr><th scope="col">사이즈</th><td class="left">
            <select name="child_size" class="select">
                <option value="">선택</option>
                <option value="65">65</option><option value="70">70</option><option value="75">75</option><option value="80">80</option><option value="85">85</option><option value="90">90</option><option value="95">95</option><option value="100">100</option><option value="105">105</option><option value="110">110</option>
            </select>
        </td></tr>
        <tr><th scope="col">연락처</th><td class="left">
            <input type="text" name="chtel1" value="{{ form_data.chtel1|default:'' }}" size="3" maxlength="4" /> -
            <input type="text" name="chtel2" value="{{ form_data.chtel2|default:'' }}" size="4" maxlength="4" /> -
            <input type="text" name="chtel3" value="{{ form_data.chtel3|default:'' }}" size="4" maxlength="4" />
        </td></tr>
        <tr><th scope="col">성별 *</th><td class="left">
            <input type="radio" name="child_sexgbn" value="M" checked /> 남자
            <input type="radio" name="child_sexgbn" value="F" /> 여자
        </td></tr>
    </tbody>
</table>
</form>
</div>
<div class="btn_right">
    <a href="javascript:fn_submit();"><img src="{% static 'ba_office/images/btn_regi.gif' %}" alt="등록" /></a>
    <a href="{% url 'office_member_list' %}"><img src="{% static 'ba_office/images/btn_cancel.gif' %}" alt="취소" /></a>
</div>
{% endblock %}
