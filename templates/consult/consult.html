{% extends "base.html" %}
{% load static %}

{% block title %}상담신청 - AAFC{% endblock %}

{% block content %}
    <div id="sub_contents">
        <div class="sub_top consult"><img src="{% static 'images/sub/sub_top_m_consult.jpg' %}" alt=""/></div>
        <div class="sub_menu">
            <ul>
                <li class="present"><a href="{% url 'consult:consult' %}">상담신청</a></li>
                <li><a href="{% url 'consult:free' %}">무료수업체험 신청</a></li>
            </ul>
        </div>

        <div class="sub_contents">
            <h2 class="sub_tit">상담신청<span><img src="{% static 'images/sub/home_ico.jpg' %}" alt=""/>HOME&nbsp;&nbsp;>&nbsp;&nbsp;<b>상담신청</b></span></h2>
            <h3 class="member_tit"><img src="{% static 'images/sub/join_ico_06.png' %}" alt=""/>개인정보 수집/이용 동의 [필수]</h3>
            <div class="join_info">
                <table summary="">
                    <tbody>
                        <tr>
                            <th><img src="{% static 'images/sub/join_info_ico.png' %}" alt=""/>목적</th>
                            <td>온라인 상담 접수를 위한 신청자 식별 정보</td>
                        </tr>
                        <tr>
                            <th><img src="{% static 'images/sub/join_info_ico.png' %}" alt=""/>항목</th>
                            <td>지역,신청자명,연락처,수강생명,성별,나이</td>
                        </tr>
                        <tr>
                            <th><img src="{% static 'images/sub/join_info_ico.png' %}" alt=""/>보유기간</th>
                            <td>상담 신청자의 요청이 있을때까지 보관</td>
                        </tr>
                        <tr>
                            <th><img src="{% static 'images/sub/join_info_ico.png' %}" alt=""/>동의 여부</th>
                            <td><label><input type="radio" name="privacyYN" value="Y">동의</label><label><input type="radio" name="privacyYN" value="N">동의안함</label></td>
                        </tr>
                    </tbody>
                </table>
                <p class="info_txt">※ 원활한 상담 진행을 위해서 필요한 최소한의 개인정보이므로 동의를 해주셔야 상담 접수가 가능합니다.</p>
            </div>

            <form name="consult_form" method="post" action="{% url 'consult:consult' %}">
                {% csrf_token %}

            <h3 class="member_tit"><img src="{% static 'images/sub/join_ico_10.png' %}" alt=""/>지역검색</h3>
            <div class="join_info">
                <table summary="">
                    <tbody>
                        <tr>
                            <th><img src="{% static 'images/sub/join_info_ico.png' %}" alt=""/>지역명</th>
                            <td><input type="text" name="sword" id="sword" value="" onkeydown="if (event.keyCode == 13){ search_stadium();return false;}" class="w_normal"/><a href="javascript:search_stadium();"><img src="{% static 'images/sub/place_search.jpg' %}" alt="" class="other"/></a></td>
                        </tr>
                    </tbody>
                </table>
                <p class="info_txt">※ 서울지역은 "구"를 서울 외 지역은 "시"를 입력하여주세요 ex)마포구, 시흥시</p>
            </div>

            <h3 class="member_tit"><img src="{% static 'images/sub/join_ico_11.png' %}" alt=""/>구장선택</h3>
            <div class="edu_select">
                <ul class="depth_5" id="area_stadium">
                    <li>지역을 검색하여 주세요</li>
                </ul>
            </div>

            <h3 class="member_tit"><img src="{% static 'images/sub/join_ico_06.png' %}" alt=""/>상담 입력</h3>
            <div class="join_info">
                <table summary="">
                    <tbody>
                        <tr>
                            <th><img src="{% static 'images/sub/join_info_ico.png' %}" alt=""/>상담유형</th>
                            <td>
                                <select name="consult_category" id="consult_category" class="w_normal">
                                    {% for cat in consult_categories %}
                                    <option value="{{ cat.subcode }}">{{ cat.code_name }}</option>
                                    {% endfor %}
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <th><img src="{% static 'images/sub/join_info_ico.png' %}" alt=""/>신청자명</th>
                            <td><input type="text" name="consult_name" id="consult_name" maxlength="30" class="w_normal"/></td>
                        </tr>
                        <tr class="contact">
                            <th><img src="{% static 'images/sub/join_info_ico.png' %}" alt=""/>연락처</th>
                            <td>
                                <select name="ctel1" id="ctel1">
                                    <option value="">선택</option>
                                    <option value="010">010</option>
                                    <option value="011">011</option>
                                    <option value="016">016</option>
                                    <option value="017">017</option>
                                    <option value="018">018</option>
                                    <option value="019">019</option>
                                </select><span>-</span><input type="text" name="ctel2" id="ctel2" maxlength="4"/><span>-</span><input type="text" name="ctel3" id="ctel3" maxlength="4"/>
                            </td>
                        </tr>
                        <tr>
                            <th><img src="{% static 'images/sub/join_info_ico.png' %}" alt=""/>수강생명</th>
                            <td><input type="text" name="stu_name" id="stu_name" maxlength="30" class="w_normal"/></td>
                        </tr>
                        <tr>
                            <th><img src="{% static 'images/sub/join_info_ico.png' %}" alt=""/>성별</th>
                            <td>
                                <select name="stu_sex" id="stu_sex" class="w_normal">
                                    <option value="M">남자</option>
                                    <option value="F">여자</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <th><img src="{% static 'images/sub/join_info_ico.png' %}" alt=""/>나이</th>
                            <td><input type="text" name="stu_age" id="stu_age" maxlength="2" class="w_normal"/></td>
                        </tr>
                        <tr>
                            <th><img src="{% static 'images/sub/join_info_ico.png' %}" alt=""/>제목</th>
                            <td><input type="text" name="consult_title" id="consult_title" maxlength="50" class="w_max"/></td>
                        </tr>
                        <tr>
                            <th><img src="{% static 'images/sub/join_info_ico.png' %}" alt=""/>신청내용</th>
                            <td><textarea name="consult_content" id="consult_content" class="w_max"></textarea></td>
                        </tr>
                        <tr>
                            <td colspan="2">축구수업 상담등록을 위한 정보를 입력해 주세요. 등록이 완료된 상담은 개별적으로 연락을 드립니다.</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            </form>

            <div class="join_btn">
                <a href="javascript:snd_con();"><img src="{% static 'images/sub/counseling_btn.png' %}" alt=""/></a>
            </div>
        </div>
    </div>
{% endblock %}

{% block extra_js %}
<script type="text/javascript">
    function search_stadium() {
        var stxt = $("#sword").val();
        if (!stxt) { alert("지역명을 입력하세요"); return; }
        $("#area_stadium").load("{% url 'consult:search_stadium' %}?stxt=" + encodeURIComponent(stxt));
    }

    function snd_con() {
        var radioval = $('input:radio[name="privacyYN"]:checked').val();
        if (radioval != "Y") {
            alert("개인정보 수집/이용에 동의하셔야 상담 신청이 가능합니다.");
            return;
        }

        var selStaCode = $('input[name="sta_code"]:checked').val();
        if (!selStaCode || !$.isNumeric(selStaCode)) {
            alert("구장을 선택하여 주세요");
            return;
        }

        if ($("#consult_name").val() == "") { alert("신청자명을 입력하여 주세요"); return; }
        if ($("#ctel1").val() == "") { alert("연락처를 선택하여 주세요"); return; }
        if ($("#ctel2").val() == "") { alert("연락처를 입력하여 주세요"); return; }
        if ($("#ctel3").val() == "") { alert("연락처를 입력하여 주세요"); return; }
        if ($("#stu_name").val() == "") { alert("수강생명을 입력하여 주세요"); return; }
        if ($("#stu_age").val() == "") { alert("나이를 입력하여 주세요"); return; }
        if ($("#consult_title").val() == "") { alert("제목을 입력하여 주세요"); return; }
        if ($("#consult_content").val() == "") { alert("내용을 입력하여 주세요"); return; }

        var con = confirm("온라인상담 등록하시겠습니까? 등록후에는 담당자가 개별 연락 예정입니다.");
        if (con) {
            consult_form.submit();
        }
    }
</script>
{% endblock %}
